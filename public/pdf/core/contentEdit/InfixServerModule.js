(function(){(function(h){function b(c){if(f[c])return f[c].exports;var d=f[c]={i:c,l:!1,exports:{}};h[c].call(d.exports,d,d.exports,b);d.l=!0;return d.exports}var f={};b.m=h;b.c=f;b.d=function(c,d,g){b.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:g})};b.r=function(c){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"});Object.defineProperty(c,"__esModule",{value:!0})};b.t=function(c,d){d&1&&(c=b(c));if(d&8||d&4&&"object"===typeof c&&c&&c.__esModule)return c;
var g=Object.create(null);b.r(g);Object.defineProperty(g,"default",{enumerable:!0,value:c});if(d&2&&"string"!=typeof c)for(var f in c)b.d(g,f,function(a){return c[a]}.bind(null,f));return g};b.n=function(c){var d=c&&c.__esModule?function(){return c["default"]}:function(){return c};b.d(d,"a",d);return d};b.o=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)};b.p="/core/contentEdit";return b(b.s=0)})([function(h,b,f){h.exports=f(1)},function(h,b,f){function c(a,c){FS.writeFile("importCommand.xml",
"<InfixServer>"+a+"</InfixServer>");k.ccall("wasmRunXML","number",["string","string"],["importCommand.xml",c])}function d(){1==g?postMessage({cmd:"isReady"}):setTimeout(d,300)}var g=!1,k={noInitialRun:!0,onRuntimeInitialized:function(){g=!0}};self.Module=k;importScripts("InfixServer.js");onmessage=function(a){a=a.data;switch(a.cmd){case "isReady":d();break;case "initialiseInfixServer":a=a.l;k.callMain([""]);k.ccall("wasmInitInfixServer","number",["string","string","string"],["infixcore.cfg",a,"results.xml"]);
a=FS.readFile("results.xml").buffer;postMessage({cmd:"initialiseInfixServer",resultsXML:a},[a]);break;case "exportFile":var e=a.pdfFile,b=a.tableData;if(a.performExport){a=new Uint8Array(e);FS.writeFile("inputFile.pdf",a);a=new Uint8Array(b);a=(new TextDecoder("utf-8")).decode(a);b='<Commands><Command Name="LoadPDF"><File>inputFile.pdf</File></Command><Command Name="Page BBox"><StartPage>1</StartPage><EndPage>1</EndPage></Command>';""!=a&&(b+='<Command Name="AddTableBoxes">'+a+"</Command>");c(b+'<Command Name="Translate Export"><File>exported.xml</File><TransXML>coreTransXML.cfg</TransXML><StartPage>1</StartPage><EndPage>1</EndPage></Command><Command Name="Edit Page"><Output>objects.xml</Output><ImagesOnly/></Command>',
"results.xml");a=FS.readFile("inputFile.pdf").buffer;b=FS.readFile("exported.xml").buffer;e=FS.readFile("objects.xml").buffer;var f=FS.readFile("results.xml").buffer;hasBeenExported=!0;postMessage({cmd:"exportFile",exportPerformed:!0,pdfBuffer:a,exportXML:b,objectXML:e,resultsXML:f},[a,b,f])}else postMessage({cmd:"exportFile",exportPerformed:!1});break;case "importText":e=a.webFontURL;b=a.galleyId;a=new Uint8Array(a.importData);a=(new TextDecoder("utf-8")).decode(a);FS.writeFile("editText.xml",a);
a='<Commands><Command Name="Translate Import"><File>editText.xml</File><StartPage>1</StartPage><EndPage>LastPage</EndPage><AutoSubstitute/><AutoDeleteParas/><Fitting><Shrink><FontSize Min="0.65">true</FontSize><Leading>False</Leading></Shrink><Stretch><FontSize>False</FontSize><Leading>False</Leading></Stretch></Fitting><ResetLetterSpacing/><IgnoreFlightCheck/><MissingFont>Noto Sans Regular</MissingFont><SubstituteAllChars/>'+("<WebFontURL>"+e+"</WebFontURL>")+"<TargetLang>en</TargetLang></Command>";
a+='<Command Name="SavePDF"><File>outputFile.pdf</File></Command>';a+='<Command Name="DumpObjectBBox"><GID>'+b+"</GID></Command></Commands>";c(a,"results.xml");a=FS.readFile("outputFile.pdf").buffer;e=FS.readFile("results.xml").buffer;postMessage({cmd:"importText",pdfBuffer:a,resultsXML:e,id:b},[a,e]);break;case "transformObject":b=a.objectID;f=!0===a.isText?"<GID>"+b+"</GID>":"<OID>"+b+"</OID>";e='<Commands><Command Name="TransformToRect">'+f+("<Rect><Top>"+a.topVal+"</Top><Left>"+a.leftVal+"</Left>");
e+="<Bottom>"+a.bottomVal+"</Bottom><Right>"+a.rightVal+"</Right>";c(e+'</Rect><GroupWide>true</GroupWide></Command><Command Name="SavePDF"><File>outputFile.pdf</File></Command>'+('<Command Name="DumpObjectBBox">'+f+"</Command></Commands>"),"results.xml");a=FS.readFile("outputFile.pdf").buffer;e=FS.readFile("results.xml").buffer;postMessage({cmd:"transformObject",pdfBuffer:a,resultsXML:e,id:b},[a,e]);break;case "deleteObject":b=a.objectID,e='<Commands><Command Name="DeleteObject">',e=!0===a.isText?
e+("<GID>"+b+"</GID></Command>"):e+("<OID>"+b+"</OID></Command>"),c(e+'<Command Name="SavePDF"><File>outputFile.pdf</File></Command></Commands>',"results.xml"),a=FS.readFile("outputFile.pdf").buffer,e=FS.readFile("results.xml").buffer,postMessage({cmd:"deleteObject",pdfBuffer:a,resultsXML:e,id:b},[a,e])}}}]);}).call(this || window)
